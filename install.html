<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="description" content="ç†Šç†Šè²“è²“å¾…è¾¦æ¸…å–®APPï½œè¨­å®šèˆ‡å®‰è£æ•™å­¸" />
  <title> ç†Šç†Šè²“è²“å¾…è¾¦æ¸…å–®APPï½œè¨­å®šèˆ‡å®‰è£æ•™å­¸ </title>
  <style>
    :root {
      --bg: #faf8f5;
      --card: #fff;
      --text: #2d2d2d;
      --text-muted: #6b6b6b;
      --accent: #e8b4bc;
      --accent-dark: #d4a0a8;
      --success: #5fd39c;
      --border: #eee;
      --shadow: 0 2px 12px rgba(0,0,0,0.06);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "PingFang TC", "Microsoft JhengHei", sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      padding-bottom: 40px;
    }
    a { color: #c97b84; text-decoration: none; }
    a:hover { text-decoration: underline; }
    a[target="_blank"]::after { content: " â†—"; font-size: 0.8em; opacity: 0.7; }

    /* Config - é›†ä¸­ç®¡ç†é€£çµ */
    .config { display: none; }
    #config-sheet-url { content: attr(data-url); }
    #config-feedback-url { content: attr(data-url); }
    #config-settings-url { content: attr(data-url); }

    .container { max-width: 800px; margin: 0 auto; padding: 0 12px; }

    /* Hero */
    .hero {
      text-align: center;
      padding: 48px 24px 40px;
    }
    .hero h1 {
      font-size: 24px;
      font-weight: 700;
      margin: 0 0 12px;
      color: var(--text);
      line-height: 1.35;
    }
    .hero .sub {
      font-size: 15px;
      color: var(--text-muted);
      margin-bottom: 28px;
    }
    .hero-btns { display: flex; flex-direction: column; gap: 12px; }
    .btn {
      display: inline-block;
      padding: 16px 24px;
      border-radius: 999px;
      font-size: 16px;
      font-weight: 600;
      text-align: center;
      cursor: pointer;
      border: none;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .btn:active { transform: scale(0.98); }
    .btn-primary {
      background: linear-gradient(135deg, #e8b4bc, #d4a0a8);
      color: #fff;
      box-shadow: 0 4px 14px rgba(212,160,168,0.4);
    }
    .btn-secondary {
      background: var(--card);
      color: var(--text);
      border: 2px solid var(--border);
    }

    .section-title-main {
      font-size: 18px;
      font-weight: 700;
      margin: 32px 0 12px;
      color: var(--text);
    }
    .section-intro {
      font-size: 14px;
      color: var(--text-muted);
      margin-bottom: 20px;
    }
    .step-tip {
      font-size: 13px;
      color: var(--text-muted);
      margin-top: 8px;
      padding-left: 4px;
    }
    .step-divider {
      border: none;
      border-top: 1px solid var(--border);
      margin: 16px 0;
    }
    .step-detail .step-desc {
      margin: 8px 0 0 0;
    }

    /* Steps */
    .steps { padding: 0 0 32px; }
    .step-card {
      background: var(--card);
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 16px;
      box-shadow: var(--shadow);
      border: 1px solid var(--border);
    }
    .step-header {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      cursor: pointer;
    }
    .step-num {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--accent);
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 14px;
      flex-shrink: 0;
    }
    .step-title { font-size: 17px; font-weight: 600; margin: 0; flex: 1; }
    .step-expand {
      width: 28px;
      height: 28px;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-muted);
      transition: transform 0.3s ease;
    }
    .step-card.open .step-expand { transform: rotate(180deg); color: var(--accent-dark); }
    .step-expand svg { width: 20px; height: 20px; }
    .step-desc {
      margin: 12px 0 0 44px;
      font-size: 14px;
      color: var(--text-muted);
    }
    .step-accordion {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
    }
    .step-accordion.open { max-height: 2000px; }
    .step-detail {
      margin: 16px 0 0 44px;
      padding-top: 16px;
      border-top: 1px solid var(--border);
      font-size: 14px;
      color: var(--text);
    }
    .step-detail img {
      max-width: 100%;
      border-radius: 8px;
      margin: 12px 0;
      border: 1px solid var(--border);
    }
    .step-imgs-row {
      display: flex;
      gap: 12px;
      margin-top: 16px;
      flex-wrap: wrap;
    }
    .step-imgs-row .step-img {
      flex: 1;
      min-width: 80px;
      margin: 0;
    }
    .step-img-placeholder {
      height: 160px;
      background: #f5f5f5;
      border-radius: 8px;
      margin: 12px 0;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-muted);
      font-size: 13px;
    }
    .step-videos {
      margin: 12px 0;
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
    }
    .step-video-item {
      flex: 1;
      min-width: 140px;
    }
    .step-video-item .step-video-label {
      font-size: 12px;
      color: var(--text-muted);
      margin: 0 0 6px 0;
    }
    .step-video-item video {
      width: 100%;
      max-width: 100%;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: #000;
    }

    /* æ‰‹æ©Ÿç‰ˆï¼šstep-videos æ”¹ç‚ºä¸Šä¸‹æ’åˆ—ï¼ˆlabel åœ¨å°æ‡‰ video ä¸Šæ–¹ï¼‰ï¼Œstep-imgs-row ä¸Šä¸‹æ’åˆ—ï¼Œåœ–ç‰‡å®Œæ•´é¡¯ç¤ºï¼Œå‰å¾€è¨­å®šé éš±è— */
    @media (max-width: 768px) {
      .step-videos {
        flex-direction: column;
      }
      .step-video-item {
        min-width: 100%;
      }
      .step-imgs-row {
        flex-direction: column;
      }
      .step-imgs-row .step-img {
        max-width: 100%;
        width: 100%;
        height: auto;
        object-fit: contain;
        flex: none;
      }
      .step-imgs-row {
        overflow: visible;
      }
      #acc11.open {
        max-height: 8000px;
      }
      .go-settings-btn {
        display: none !important;
      }
    }

    .copy-btn {
      margin-top: 12px;
      padding: 10px 20px;
      background: var(--accent);
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      cursor: pointer;
    }
    .copy-btn:active { opacity: 0.9; }
    .copy-btn-before-code { margin-bottom: 16px; }
    .code-block {
      background: #1e1e1e;
      color: #e0e0e0;
      padding: 16px;
      border-radius: 8px;
      font-family: "SF Mono", Monaco, monospace;
      font-size: 12px;
      overflow-x: auto;
      max-height: 240px;
      overflow-y: auto;
    }

    /* FAQ */
    .faq { padding: 24px 0; }
    .section-title {
      font-size: 20px;
      font-weight: 700;
      margin: 0 0 20px;
      padding: 0 4px;
    }
    .faq-item {
      background: var(--card);
      border-radius: 12px;
      margin-bottom: 12px;
      overflow: hidden;
      box-shadow: 0 1px 4px rgba(0,0,0,0.05);
    }
    .faq-q {
      padding: 16px 20px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .faq-q::after {
      content: "+";
      font-size: 18px;
      color: var(--text-muted);
      transition: transform 0.3s;
    }
    .faq-item.open .faq-q::after { transform: rotate(45deg); }
    .faq-a {
      padding: 0 20px;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
    }
    .faq-item.open .faq-a { max-height: 500px; }
    .faq-a-inner {
      padding: 0 0 16px;
      font-size: 14px;
      color: var(--text-muted);
      line-height: 1.6;
    }

    /* Troubleshooting */
    .trouble { padding: 24px 0; }
    .trouble-item {
      background: var(--card);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 12px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.05);
    }
    .trouble-symptom { font-weight: 600; color: #c97b84; margin-bottom: 8px; }
    .trouble-fix { font-size: 14px; color: var(--text-muted); }

    /* Security */
    .security {
      background: linear-gradient(135deg, #f8f0f2, #f5e8eb);
      border-radius: 16px;
      padding: 24px;
      margin: 24px 0;
    }
    .security h3 { margin: 0 0 12px; font-size: 16px; }
    .security p { margin: 0; font-size: 14px; color: var(--text-muted); }

    /* Footer */
    footer {
      text-align: center;
      padding: 40px 20px;
      font-size: 13px;
      color: var(--text-muted);
    }
    footer a { color: var(--text-muted); }
  </style>
</head>
<body>
  <!-- Config å€å¡Šï¼šé›†ä¸­ç®¡ç† -->
  <div class="config" id="config">
    <span id="config-sheet-url" data-url="https://docs.google.com/spreadsheets/d/1_38-IQwS9Vj1iHzXWJAQ68WghhwBUvRGLVG8RobUDpg/copy">Sheet ç¯„æœ¬</span>
    <span id="config-feedback-url" data-url="https://forms.google.com/YOUR_FEEDBACK_FORM">å›é¥‹è¡¨å–®</span>
    <span id="config-settings-url" data-url="./settings.html">è¨­å®šé </span>
  </div>

  <div class="container">
    <!-- Hero -->
    <section class="hero">
      <h1>ç†Šç†Šè²“è²“å¾…è¾¦æ¸…å–®APPï½œè¨­å®šèˆ‡å®‰è£æ•™å­¸</h1>
      <p class="sub">æœ¬å¾…è¾¦æ¸…å–®ä½¿ç”¨ <strong>ä½ è‡ªå·±çš„ Google Sheets</strong> ç•¶è³‡æ–™åº«</p>
      <p class="sub">ä¸ç”¨è¨»å†Šã€ä¸ç”¨ä¸‹è¼‰ Appï¼Œè³‡æ–™åªå±¬æ–¼ä½ å€‘ â¤ï¸</p>
      <p class="sub">æ•´å€‹æµç¨‹å¤§ç´„ 5â€“10 åˆ†é˜å®Œæˆ</p>
      <a href="./settings.html" class="btn btn-secondary" style="margin-top:16px">æˆ‘å·²ç¶“æœ‰é€£ç·šç¶²å€äº†ï¼Œç›´æ¥è¨­å®š</a>
    </section>

    <!-- Steps -->
    <section class="steps" id="steps">
      <h2 class="section-title-main">ä¸€ã€å»ºç«‹ä½ å€‘å°ˆå±¬çš„å¾…è¾¦æ¸…å–®ã€Œè³‡æ–™åº«ã€ï¼ˆå»ºè­°ç”¨é›»è…¦å®Œæˆï¼‰</h2>
      <p class="section-intro">é€™ä¸€æ­¥çš„ç›®çš„åªæœ‰ä¸€å€‹ï¼šå¹«ä½ å€‘å»ºç«‹ä¸€ä»½ã€Œåªå±¬æ–¼ä½ å€‘çš„å¾…è¾¦æ¸…å–®ã€ï¼Œä¹‹å¾Œæ‰‹æ©Ÿ App æ‰çŸ¥é“è³‡æ–™è¦å­˜åœ¨å“ªè£¡ã€‚</p>
      <p class="section-intro">ä¸ç”¨æ‡‚ç¨‹å¼ï¼Œåªè¦ç…§è‘—ç•«é¢é»å°±å¥½ ğŸ‘‡</p>

      <!-- Step 1 -->
      <div class="step-card" id="step1" data-step="1">
        <div class="step-header" onclick="toggleAccordion(1)">
          <span class="step-num">1</span>
          <h2 class="step-title">å»ºç«‹google sheetsè³‡æ–™è¡¨</h2>
          <div class="step-expand"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></div>
        </div>
        <p class="step-desc">é€éå¾…è¾¦æ¸…å–®è³‡æ–™è¡¨ç¯„æœ¬å»ºç«‹</p>
        <div class="step-accordion" id="acc1">
          <div class="step-detail">
            <p class="step-desc">1-1 é»æ“Šæ•™å­¸é ä¸Šçš„ã€è¤‡è£½å¾…è¾¦æ¸…å–®è³‡æ–™è¡¨ã€‘æŒ‰éˆ•ã€‚</p>
            <p><a href="https://docs.google.com/spreadsheets/d/1_38-IQwS9Vj1iHzXWJAQ68WghhwBUvRGLVG8RobUDpg/copy" target="_blank" class="btn copy-btn">ğŸ‘‰é»æˆ‘ã€è¤‡è£½å¾…è¾¦æ¸…å–®è³‡æ–™è¡¨ã€‘</a></p>
            <hr class="step-divider" />
            <p class="step-desc">1-2 ç•«é¢æœƒå‡ºç¾ã€Œè¤‡è£½æ–‡ä»¶ã€ï¼Œç›´æ¥é»æ“Šè—è‰²çš„ã€å»ºç«‹å‰¯æœ¬ã€‘ã€‚</p>
            <p><img src="manual/01.png" alt="" class="step-img" /></p>
            <hr class="step-divider" />
            <p class="step-desc">1-3 ç›´æ¥é»æ“Šè—è‰²çš„ã€å»ºç«‹å‰¯æœ¬ã€‘ã€‚</p>
            <p><img src="manual/01-1.png" alt="" class="step-img" /></p>
            <p class="step-tip">ğŸ“Œ å°æé†’ï¼šä¸ç”¨æ”¹åç¨±ã€ä¸ç”¨é¸è³‡æ–™å¤¾ï¼Œé€™ä»½è¡¨æ ¼æœƒè‡ªå‹•å­˜åˆ°ä½ çš„ Google é›²ç«¯ç¡¬ç¢Ÿ</p>
          </div>
        </div>
      </div>

      <!-- Step 2 -->
      <div class="step-card" id="step2" data-step="2">
        <div class="step-header" onclick="toggleAccordion(2)">
          <span class="step-num">2</span>
          <h2 class="step-title">æ‰“é–‹ Google sheets çš„ã€ŒApps Scriptã€è¨­å®šé é¢</h2>
          <div class="step-expand"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></div>
        </div>
        <p class="step-desc">åœ¨å‰›å‰›è¤‡è£½å¥½çš„ Google sheets ä¸­ï¼Œé»æ“Šä¸Šæ–¹é¸å–®ã€æ“´å……åŠŸèƒ½ã€‘â†’ã€Apps Scriptã€‘ã€‚</p>
        <div class="step-accordion" id="acc2">
          <div class="step-detail">
            <img src="manual/02.png" alt="æ“´å……åŠŸèƒ½ â†’ Apps Script" class="step-img" />
          </div>
        </div>
      </div>

      <!-- Step 3 -->
      <div class="step-card" id="step3" data-step="3">
        <div class="step-header" onclick="toggleAccordion(3)">
          <span class="step-num">3</span>
          <h2 class="step-title">è¨­å®šç¨‹å¼ç¢¼</h2>
          <div class="step-expand"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></div>
        </div>
        <p class="step-desc">æŠŠåŸæœ¬ç¨‹å¼ç¢¼æ¸…ç©ºï¼Œè²¼ä¸Šæˆ‘å€‘æº–å‚™å¥½çš„ç¨‹å¼ç¢¼ï¼Œé»æ“Šã€Œå„²å­˜ã€</p>
        <div class="step-accordion" id="acc3">
          <div class="step-detail">
            <p><img src="manual/04.png" alt="" class="step-img" /></p>
            <button class="copy-btn copy-btn-before-code" onclick="copyScript()">è¤‡è£½ç¨‹å¼ç¢¼</button>
            <div class="code-block" id="scriptCode">// Sheet configuration
const SHEET_NAME = 'items';
const HEADER_ROW = 1;

// Column indices (0-based)
const COL_ID = 0;
const COL_TEXT = 1;
const COL_TYPE = 2;
const COL_SUBTYPE = 3;
const COL_PRIORITY = 4;
const COL_STATUS = 5;
const COL_CREATED_AT = 6;
const COL_UPDATED_AT = 7;
const COL_DUE_DATE = 8;
const COL_CREATED_BY = 9;
const COL_NOTE = 10;
const COL_ASSIGNEE = 11;

// GET handler
function doGet(e) {
  try {
    const action = e.parameter.action || '';
    
    if (action === 'items') {
      return handleGetItems(e);
    } else if (action === 'calendar') {
      return handleGetCalendar(e);
    } else {
      return createResponse({ error: 'Invalid action' }, 400);
    }
  } catch (error) {
    return createResponse({ error: error.toString() }, 500);
  }
}

// POST handler
function doPost(e) {
  try {
    let postData;
    
    // Handle FormData
    if (e.parameter &amp;&amp; e.parameter.payload) {
      postData = JSON.parse(e.parameter.payload);
    }
    // Handle JSON body
    else if (e.postData &amp;&amp; e.postData.contents) {
      postData = JSON.parse(e.postData.contents);
    } else {
      return createResponse({ error: 'No POST data received' }, 400);
    }
    
    const action = postData.action || '';
    
    if (action === 'create') {
      return handleCreateItem(postData);
    } else if (action === 'update') {
      return handleUpdateItem(postData);
    } else if (action === 'archive') {
      return handleArchiveItem(postData);
    } else {
      return createResponse({ error: 'Invalid action: ' + action }, 400);
    }
  } catch (error) {
    return createResponse({ error: error.toString() }, 500);
  }
}

// GET /items
function handleGetItems(e) {
  const sheet = getSheet();
  const data = sheet.getDataRange().getValues();
  const rows = data.slice(HEADER_ROW);
  
  let items = rows.map((row) =&gt; {
    return {
      id: row[COL_ID],
      text: row[COL_TEXT],
      type: row[COL_TYPE],
      subtype: row[COL_SUBTYPE] || '',
      priority: row[COL_PRIORITY],
      status: row[COL_STATUS],
      createdAt: row[COL_CREATED_AT],
      updatedAt: row[COL_UPDATED_AT],
      dueDate: row[COL_DUE_DATE] || '',
      createdBy: row[COL_CREATED_BY] || '',
      note: row[COL_NOTE] || '',
      assignee: (row[COL_ASSIGNEE] !== undefined &amp;&amp; row[COL_ASSIGNEE] !== null) ? row[COL_ASSIGNEE] : ''
    };
  });
  
  // Filter by status
  const status = e.parameter.status || 'active';
  items = items.filter(item =&gt; item.status === status);
  
  // Filter by type if specified
  if (e.parameter.type) {
    items = items.filter(item =&gt; item.type === e.parameter.type);
  }
  
  // Sort: priority (high -&gt; mid -&gt; low), then updatedAt desc
  const priorityOrder = { high: 1, mid: 2, low: 3 };
  items.sort((a, b) =&gt; {
    const priorityDiff = (priorityOrder[a.priority] || 99) - (priorityOrder[b.priority] || 99);
    if (priorityDiff !== 0) return priorityDiff;
    return (b.updatedAt || 0) - (a.updatedAt || 0);
  });
  
  return createResponse({ items: items });
}

// POST /items (create)
function handleCreateItem(data) {
  const sheet = getSheet();
  const now = Date.now();
  const id = 'it_' + now;
  
  const row = [
    id,
    data.text || '',
    data.type || 'todo',
    data.subtype || '',
    data.priority || 'mid',
    'active',
    now,
    now,
    data.dueDate || '',
    data.createdBy || '',
    data.note || '',
    data.assignee || ''
  ];
  
  sheet.appendRow(row);
  
  return createResponse({
    success: true,
    item: {
      id: id,
      text: data.text,
      type: data.type,
      subtype: data.subtype || '',
      priority: data.priority,
      status: 'active',
      createdAt: now,
      updatedAt: now,
      dueDate: data.dueDate || '',
      createdBy: data.createdBy || '',
      note: data.note || '',
      assignee: data.assignee || ''
    }
  });
}

// PATCH /items/:id (update)
function handleUpdateItem(data) {
  const sheet = getSheet();
  const dataRange = sheet.getDataRange();
  const values = dataRange.getValues();
  
  let rowIndex = -1;
  for (let i = HEADER_ROW; i &lt; values.length; i++) {
    if (values[i][COL_ID] === data.id) {
      rowIndex = i;
      break;
    }
  }
  
  if (rowIndex === -1) {
    return createResponse({ error: 'Item not found' }, 404);
  }
  
  const row = values[rowIndex];
  const now = Date.now();
  
  // Ensure row has enough columns (for backward compatibility)
  while (row.length &lt;= COL_ASSIGNEE) {
    row.push('');
  }
  
  if (data.status !== undefined) row[COL_STATUS] = data.status;
  if (data.text !== undefined) row[COL_TEXT] = data.text;
  if (data.priority !== undefined) row[COL_PRIORITY] = data.priority;
  if (data.subtype !== undefined) row[COL_SUBTYPE] = data.subtype;
  if (data.assignee !== undefined) row[COL_ASSIGNEE] = data.assignee;
  if (data.dueDate !== undefined) row[COL_DUE_DATE] = data.dueDate;
  if (data.note !== undefined) row[COL_NOTE] = data.note;
  
  row[COL_UPDATED_AT] = now;
  
  const range = sheet.getRange(rowIndex + 1, 1, 1, row.length);
  range.setValues([row]);
  
  return createResponse({
    success: true,
    item: {
      id: row[COL_ID],
      text: row[COL_TEXT],
      type: row[COL_TYPE],
      subtype: row[COL_SUBTYPE] || '',
      priority: row[COL_PRIORITY],
      status: row[COL_STATUS],
      createdAt: row[COL_CREATED_AT],
      updatedAt: row[COL_UPDATED_AT],
      dueDate: row[COL_DUE_DATE] || '',
      createdBy: row[COL_CREATED_BY] || '',
      note: row[COL_NOTE] || '',
      assignee: (row[COL_ASSIGNEE] !== undefined &amp;&amp; row[COL_ASSIGNEE] !== null) ? row[COL_ASSIGNEE] : ''
    }
  });
}

// PATCH /items/:id/archive
function handleArchiveItem(data) {
  const sheet = getSheet();
  const dataRange = sheet.getDataRange();
  const values = dataRange.getValues();
  
  let rowIndex = -1;
  for (let i = HEADER_ROW; i &lt; values.length; i++) {
    if (values[i][COL_ID] === data.id) {
      rowIndex = i;
      break;
    }
  }
  
  if (rowIndex === -1) {
    return createResponse({ error: 'Item not found' }, 404);
  }
  
  const row = values[rowIndex];
  row[COL_STATUS] = 'archived';
  row[COL_UPDATED_AT] = Date.now();
  
  const range = sheet.getRange(rowIndex + 1, 1, 1, row.length);
  range.setValues([row]);
  
  return createResponse({ success: true });
}

// GET /calendar
function handleGetCalendar(e) {
  const days = parseInt(e.parameter.days || '3', 10);
  const calendar = CalendarApp.getDefaultCalendar();
  const now = new Date();
  const endDate = new Date(now.getTime() + days * 24 * 60 * 60 * 1000);
  
  const events = calendar.getEvents(now, endDate);
  
  const eventsByDate = {};
  const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
  
  events.forEach(event =&gt; {
    const eventDate = new Date(event.getStartTime());
    const dateKey = formatDate(eventDate);
    const dateLabel = getDateLabel(eventDate, today);
    
    if (!eventsByDate[dateKey]) {
      eventsByDate[dateKey] = {
        date: dateKey,
        label: dateLabel,
        events: []
      };
    }
    
    eventsByDate[dateKey].events.push({
      start: formatTime(event.getStartTime()),
      end: formatTime(event.getEndTime()),
      title: event.getTitle(),
      description: event.getDescription() || ''
    });
  });
  
  const daysArray = Object.values(eventsByDate).sort((a, b) =&gt; {
    return a.date.localeCompare(b.date);
  });
  
  return createResponse({ days: daysArray });
}

// Helper: Get sheet
function getSheet() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  let sheet = ss.getSheetByName(SHEET_NAME);
  
  if (!sheet) {
    sheet = ss.insertSheet(SHEET_NAME);
    sheet.getRange(HEADER_ROW, 1, 1, 12).setValues([[
      'id', 'text', 'type', 'subtype', 'priority', 'status',
      'createdAt', 'updatedAt', 'dueDate', 'createdBy', 'note', 'assignee'
    ]]);
  }
  
  return sheet;
}

// Helper: Create response
function createResponse(data, statusCode = 200) {
  const output = ContentService.createTextOutput(JSON.stringify(data));
  output.setMimeType(ContentService.MimeType.JSON);
  return output;
}

// Helper: Format date
function formatDate(date) {
  const year = date.getFullYear();
  const month = String(date.getMonth() + 1).padStart(2, '0');
  const day = String(date.getDate()).padStart(2, '0');
  return `${year}-${month}-${day}`;
}

// Helper: Format time
function formatTime(date) {
  const hours = String(date.getHours()).padStart(2, '0');
  const minutes = String(date.getMinutes()).padStart(2, '0');
  return `${hours}:${minutes}`;
}

// Helper: Get date label
function getDateLabel(date, today) {
  const diffDays = Math.floor((date - today) / (1000 * 60 * 60 * 24));
  
  if (diffDays === 0) return 'Today';
  if (diffDays === 1) return 'Tomorrow';
  if (diffDays === 2) return 'Day+2';
  
  return formatDate(date);
}</div>
            <p><img src="manual/04-1.png" alt="" class="step-img" /></p>
            <p class="step-tip">ğŸ“Œ è«‹æ”¾å¿ƒï¼šä¸éœ€è¦çœ‹æ‡‚å…§å®¹ã€ä¸éœ€è¦ä¿®æ”¹ä»»ä½•ä¸€è¡Œ â€”ã€Œå…¨åˆª â†’ å…¨è²¼ â†’ å„²å­˜ã€å°±å°äº†</p>
          </div>
        </div>
      </div>

      <!-- Step 4 -->
      <div class="step-card" id="step4" data-step="4">
        <div class="step-header" onclick="toggleAccordion(4)">
          <span class="step-num">4</span>
          <h2 class="step-title">æ–°å¢éƒ¨ç½²ä½œæ¥­</h2>
          <div class="step-expand"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></div>
        </div>
        <p class="step-desc">é»æ“Šå³ä¸Šè§’ã€éƒ¨ç½²ã€‘ï¼Œé¸æ“‡ã€æ–°å¢éƒ¨ç½²ä½œæ¥­ã€‘ã€‚</p>
        <div class="step-accordion" id="acc4">
          <div class="step-detail">
            <img src="manual/05.png" alt="éƒ¨ç½² â†’ æ–°å¢éƒ¨ç½²ä½œæ¥­" class="step-img" />
          </div>
        </div>
      </div>

      <!-- Step 5 -->
      <div class="step-card" id="step5" data-step="5">
        <div class="step-header" onclick="toggleAccordion(5)">
          <span class="step-num">5</span>
          <h2 class="step-title">é¸æ“‡ã€Œç¶²é æ‡‰ç”¨ç¨‹å¼ã€</h2>
          <div class="step-expand"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></div>
        </div>
        <p class="step-desc">é»æ“Šé½’è¼ªåœ–ç¤º âš™ï¸ï¼Œé¸æ“‡ã€ç¶²é æ‡‰ç”¨ç¨‹å¼ã€‘ã€‚</p>
        <div class="step-accordion" id="acc5">
          <div class="step-detail">
            <img src="manual/06.png" alt="é¸æ“‡ç¶²é æ‡‰ç”¨ç¨‹å¼" class="step-img" />
          </div>
        </div>
      </div>

      <!-- Step 6 -->
      <div class="step-card" id="step6" data-step="6">
        <div class="step-header" onclick="toggleAccordion(6)">
          <span class="step-num">6</span>
          <h2 class="step-title">è¨­å®šå­˜å–æ¬Šé™</h2>
          <div class="step-expand"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></div>
        </div>
        <p class="step-desc">è«‹ç…§ä¸‹é¢è¨­å®šï¼šåŸ·è¡Œèº«åˆ†é¸ã€Œæˆ‘ï¼ˆä½ çš„ Google å¸³è™Ÿï¼‰ã€ã€èª°å¯ä»¥å­˜å–é¸ã€æ‰€æœ‰äººã€‘ï¼Œç„¶å¾Œé»æ“Šå³ä¸‹è§’ã€éƒ¨ç½²ã€‘->ã€æˆæ¬Šå­˜å–æ¬Šé™ã€‘ã€‚</p>
        <div class="step-accordion" id="acc6">
          <div class="step-detail">
            <p><img src="manual/07.png" alt="" class="step-img" /><img src="manual/08.png" alt="" class="step-img" /></p>
          </div>
        </div>
      </div>

      <!-- Step 7 -->
      <div class="step-card" id="step7" data-step="7">
        <div class="step-header" onclick="toggleAccordion(7)">
          <span class="step-num">7</span>
          <h2 class="step-title">Google æˆæ¬Š</h2>
          <div class="step-expand"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></div>
        </div>
        <p class="step-desc">æˆæ¬Š Google sheets è³‡æ–™å¥½è®“APPå¯ä»¥è®€å– </p>
        <div class="step-accordion" id="acc7">
          <div class="step-detail">
            <p class="step-desc">7-1 çœ‹åˆ°ã€Œé€™å€‹æ‡‰ç”¨ç¨‹å¼æœªç¶“Google é©—è­‰ã€æ˜¯æ­£å¸¸çš„ã€‚é»æ“Šã€é€²éšAdvancedã€‘â†’ã€å‰å¾€Go to ...ã€‘ã€‚(ç¬¬ä¸€æ¬¡æœƒè·³å‡ºæ­¤ç•«é¢)</p>
            <div class="step-imgs-row">
              <img src="manual/8-1.png" alt="" class="step-img" />
              <img src="manual/8-2.png" alt="" class="step-img" />
            </div>
            <hr class="step-divider" />
            <p class="step-desc">7-2 å‹¾é¸å…¨éƒ¨æ¬Šé™ â†’ é»æ“Šã€Continueã€‘ã€‚</p>
            <p><img src="manual/09.png" alt="" class="step-img" /><img src="manual/10.png" alt="" class="step-img" /></p>
            <hr class="step-divider" />
            <p class="step-tip">ğŸ“Œ é‡é»èªªæ˜ï¼šé€™å€‹æˆæ¬Šæ˜¯ã€Œä½ è‡ªå·±å…è¨±ä½ è‡ªå·±çš„Google sheetsè³‡æ–™é‹ä½œã€ï¼Œæ­¤APPçš„ä½œè€…æ˜¯çœ‹ä¸åˆ°ä½ çš„è³‡æ–™ï¼</p>
          </div>
        </div>
      </div>

      <!-- Step 8 -->
      <div class="step-card" id="step8" data-step="8">
        <div class="step-header" onclick="toggleAccordion(8)">
          <span class="step-num">8</span>
          <h2 class="step-title">è¤‡è£½ä½ çš„ã€Œå°ˆå±¬é€£ç·šç¶²å€ã€</h2>
          <div class="step-expand"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></div>
        </div>
        <p class="step-desc">ç•«é¢é¡¯ç¤ºã€Œå·²æˆåŠŸæ›´æ–°éƒ¨ç½²ä½œæ¥­ã€å¾Œï¼Œåœ¨ã€Œç¶²é æ‡‰ç”¨ç¨‹å¼ã€ä¸‹é¢é»æ“Šã€è¤‡è£½ã€‘ç¶²å€ã€‚</p>
        <div class="step-accordion" id="acc8">
          <div class="step-detail">
            <p><img src="manual/11.png" alt="" class="step-img" /></p>
            <p class="step-tip">ğŸ”‘ é€™å€‹ç¶²å€éå¸¸é‡è¦ï¼Œè«‹å…ˆç•™è‘—ï¼Œä¸‹ä¸€æ­¥æ‰‹æ©Ÿ APP æœƒç”¨åˆ°å®ƒ</p>
          </div>
        </div>
      </div>

      <h2 class="section-title-main">äºŒã€APP å®‰è£èˆ‡è¨­å®šï¼ˆæ‰‹æ©Ÿå®Œæˆï¼‰</h2>
      <p class="section-intro">æ¥ä¸‹ä¾†çš„æ­¥é©Ÿ <strong>å…¨éƒ¨ç”¨æ‰‹æ©Ÿ</strong> å°±å¯ä»¥å®Œæˆ</p>

      <!-- Step 9 -->
      <div class="step-card" id="step9" data-step="9">
        <div class="step-header" onclick="toggleAccordion(9)">
          <span class="step-num">1</span>
          <h2 class="step-title">åœ¨æ‰‹æ©Ÿä¸Šæ‰“é–‹å¾…è¾¦æ¸…å–®ç¶²é </h2>
          <div class="step-expand"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></div>
        </div>
        <p class="step-desc">ğŸ“± æƒæ QR Codeï¼Œæˆ– ç”¨æ‰‹æ©Ÿç€è¦½å™¨è¼¸å…¥ä¸‹æ–¹ç¶²å€ã€‚</p>
        <div class="step-accordion" id="acc9">
          <div class="step-detail">
            <img src="images/qrcode.png" alt="QR Code" style="max-width:200px;height:auto" />
            <p id="appUrlDisplay" style="word-break:break-all;font-size:13px;color:var(--text-muted)"></p>
            <p class="step-tip">ğŸ“Œ è«‹ä½¿ç”¨ Safariï¼ˆiPhoneï¼‰æˆ– Chromeï¼ˆAndroidï¼‰ï¼Œä¸å»ºè­°ä½¿ç”¨ IG / LINE å…§å»ºç€è¦½å™¨</p>
          </div>
        </div>
      </div>

      <!-- Step 10 -->
      <div class="step-card" id="step10" data-step="10">
        <div class="step-header" onclick="toggleAccordion(10)">
          <span class="step-num">2</span>
          <h2 class="step-title">æŠŠç¶²é åŠ å…¥åˆ°æ‰‹æ©Ÿä¸»ç•«é¢ï¼ˆåƒ APP ä¸€æ¨£ï¼‰</h2>
          <div class="step-expand"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></div>
        </div>
        <p class="step-desc">åœ¨ç€è¦½å™¨ä¸­é»æ“Šã€Œåˆ†äº«ã€æŒ‰éˆ•ï¼Œé¸æ“‡ã€ŒåŠ å…¥ä¸»ç•«é¢ã€ã€‚å®Œæˆå¾Œï¼Œæ‰‹æ©Ÿæ¡Œé¢æœƒå‡ºç¾ã€Œç†Šç†Šè²“è²“ã€åœ–ç¤º </p>
        <div class="step-accordion" id="acc10">
          <div class="step-detail">
            <div class="step-videos">
              <div class="step-video-item">
                <p class="step-video-label">Safari</p>
                <video src="manual/safari_video.mov" muted playsinline loop id="safariVideo"></video>
              </div>
              <div class="step-video-item">
                <p class="step-video-label">Chrome</p>
                <video src="manual/chrome_video.mov" muted playsinline loop id="chromeVideo"></video>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Step 11 -->
      <div class="step-card" id="step11" data-step="11">
        <div class="step-header" onclick="toggleAccordion(11)">
          <span class="step-num">3</span>
          <h2 class="step-title">è²¼ä¸Šã€Œå°ˆå±¬é€£ç·šç¶²å€ã€ï¼Œæ¸¬è©¦é€£ç·š</h2>
          <div class="step-expand"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></div>
        </div>
        <p class="step-desc">æ‰“é–‹å‰›å‰›å®‰è£å¥½çš„APPï¼Œé»æ“Šã€Œå‰å¾€è¨­å®šã€ï¼Œå°‡å‰›å‰›è¤‡è£½çš„ã€Œç¶²é æ‡‰ç”¨ç¨‹å¼ç¶²å€ã€è²¼ä¸Šï¼Œé»æ“Šã€Œæ¸¬è©¦é€£ç·šã€ã€‚</p>
        <div class="step-accordion" id="acc11">
          <div class="step-detail">
            <div class="step-imgs-row">
              <img src="manual/p3-1.png" alt="" class="step-img" />
              <img src="manual/p3-2.png" alt="" class="step-img" />
              <img src="manual/p3-3.png" alt="" class="step-img" />
            </div>
          </div>
        </div>
      </div>

      <!-- Step 12 -->
      <div class="step-card" id="step12" data-step="12">
        <div class="step-header" onclick="toggleAccordion(12)">
          <span class="step-num">4</span>
          <h2 class="step-title">å„²å­˜ä¸¦å•Ÿç”¨</h2>
          <div class="step-expand"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></div>
        </div>
        <p class="step-desc">è‹¥ç•«é¢å‡ºç¾ï¼šâœ… é€£ç·šæˆåŠŸï¼å·²è®€åˆ°ä½ çš„ Google Sheetsï¼Œè«‹é»æ“Šã€Œå„²å­˜ä¸¦å•Ÿç”¨ã€ã€‚</p>
        <div class="step-accordion" id="acc12">
          <div class="step-detail">
            <div class="step-imgs-row">
              <img src="manual/p4-1.png" alt="" class="step-img" />
              <img src="manual/p4-2.png" alt="" class="step-img" />
            </div>
          </div>
        </div>
      </div>

      <!-- Step 13 -->
      <div class="step-card" id="step13" data-step="13">
        <div class="step-header" onclick="toggleAccordion(13)">
          <span class="step-num">5</span>
          <h2 class="step-title">æ­å–œä½ ï¼APP è¨­å®šå®Œæˆ ğŸ‰</h2>
          <div class="step-expand"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></div>
        </div>
        <p class="step-desc">é»æ“Šå·¦ä¸Šè§’ã€Œè¿”å›ã€ã€‚è‹¥ç•«é¢ä¸­å‡ºç¾ã€Œç¯„ä¾‹ Aã€ã€Œç¯„ä¾‹ Bã€ç­‰é è¨­è³‡æ–™ï¼Œæ­å–œä½ ï¼å®‰è£å®Œæˆå•¦ï¼</p>
        <div class="step-accordion" id="acc13">
          <div class="step-detail">
            <div class="step-imgs-row">
              <img src="manual/p5-1.png" alt="" class="step-img" />
              <img src="manual/p5-2.png" alt="" class="step-img" />
            </div>
            <p>ğŸ‰ æ­å–œä½ ï¼ä½ å°ˆå±¬çš„ç†Šç†Šè²“è²“å¾…è¾¦æ¸…å–®å·²ç¶“å®‰è£å®Œæˆå•¦ï¼ ç¾åœ¨é–‹å§‹ï¼Œå’Œå¦ä¸€åŠä¸€èµ·è¨˜éŒ„ç”Ÿæ´»å§ â¤ï¸</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Security -->
    <section class="security">
      <h3>ğŸ”’ å®‰å…¨èˆ‡éš±ç§</h3>
      <p>ä½ çš„è³‡æ–™åªå­˜åœ¨ä½ è‡ªå·±çš„ Google å¸³è™Ÿè£¡ï¼Œä½œè€…çœ‹ä¸åˆ°ä½ çš„ä»»ä½•å…§å®¹ã€‚è¡¨æ ¼ã€é€£ç·šç¶²å€éƒ½æ˜¯ä½ å°ˆå±¬çš„ã€‚</p>
    </section>

    <!-- FAQ -->
    <section class="faq">
      <h2 class="section-title">å¸¸è¦‹å•é¡Œ</h2>
      <div class="faq-item" data-faq="1">
        <div class="faq-q">é€™å€‹è¦éŒ¢å—ï¼Ÿ</div>
        <div class="faq-a"><div class="faq-a-inner">å®Œå…¨å…è²»ï¼Œä¸éœ€è¦è¨‚é–±æˆ–ä»˜è²»ã€‚</div></div>
      </div>
      <div class="faq-item" data-faq="2">
        <div class="faq-q">æˆ‘çš„è³‡æ–™æœƒè¢«ä½œè€…çœ‹åˆ°å—ï¼Ÿ</div>
        <div class="faq-a"><div class="faq-a-inner">ä¸æœƒã€‚è³‡æ–™å­˜åœ¨ä½ è‡ªå·±çš„ Google è¡¨æ ¼è£¡ï¼Œä½œè€…ç„¡æ³•å­˜å–ä½ çš„è³‡æ–™ã€‚</div></div>
      </div>
      <div class="faq-item" data-faq="3">
        <div class="faq-q">ç‚ºä»€éº¼è¦é¸ã€Œä»»ä½•äººå¯ä»¥å­˜å–ã€ï¼Ÿæœƒä¸æœƒä¸å®‰å…¨ï¼Ÿ</div>
        <div class="faq-a"><div class="faq-a-inner">é€™æ˜¯ç‚ºäº†è®“å¾…è¾¦æ¸…å–®é€éç¶²å€è®€å¯«ä½ çš„è¡¨æ ¼ã€‚åªæœ‰çŸ¥é“é€™ä¸²ç¶²å€çš„äººæ‰èƒ½ä½¿ç”¨ï¼Œä¸€èˆ¬äººå¾ˆé›£çŒœåˆ°ã€‚ä½ çš„è¡¨æ ¼ä»ç„¶å— Google å¸³è™Ÿæ¬Šé™ä¿è­·ã€‚</div></div>
      </div>
      <div class="faq-item" data-faq="4">
        <div class="faq-q">æˆ‘è²¼äº†ç¶²å€ä½†é¡¯ç¤ºé€£ç·šå¤±æ•—æ€éº¼è¾¦ï¼Ÿ</div>
        <div class="faq-a"><div class="faq-a-inner">è«‹ç¢ºèªï¼šç¶²å€å®Œæ•´ï¼ˆçµå°¾è¦æœ‰ /execï¼‰ã€å·²åœ¨ Google é‚£é‚Šå®Œæˆéƒ¨ç½²ã€è‹¥ç”¨ IG/LINE å…§å»ºç€è¦½å™¨è«‹æ”¹ç”¨ Safari æˆ– Chromeã€‚è©³è¦‹ä¸‹æ–¹ã€Œæ’éŒ¯ã€å€ã€‚</div></div>
      </div>
      <div class="faq-item" data-faq="5">
        <div class="faq-q">å¦ä¸€åŠè¦æ€éº¼ä¸€èµ·ç”¨ï¼Ÿ</div>
        <div class="faq-a"><div class="faq-a-inner">æŠŠè¡¨æ ¼åˆ†äº«çµ¦å°æ–¹ï¼Œæˆ–æŠŠåŒä¸€æ¢é€£ç·šç¶²å€çµ¦å°æ–¹è²¼åˆ°ä»–çš„è¨­å®šé ã€‚å…©äººç”¨åŒä¸€å€‹ç¶²å€ã€åŒä¸€ä»½è¡¨æ ¼å°±èƒ½åŒæ­¥ã€‚</div></div>
      </div>
      <div class="faq-item" data-faq="6">
        <div class="faq-q">æˆ‘æ›æ‰‹æ©Ÿéœ€è¦é‡åšå—ï¼Ÿ</div>
        <div class="faq-a"><div class="faq-a-inner">ä¸éœ€è¦ã€‚åªè¦åˆ°è¨­å®šé å†è²¼ä¸€æ¬¡é€£ç·šç¶²å€ï¼Œæˆ–é‡æ–°æ‰“é–‹å¾…è¾¦æ¸…å–®é é¢å³å¯ã€‚</div></div>
      </div>
      <div class="faq-item" data-faq="7">
        <div class="faq-q">å¯ä»¥åŒ¯å‡ºè³‡æ–™å—ï¼Ÿ</div>
        <div class="faq-a"><div class="faq-a-inner">å¯ä»¥ï¼è¡¨æ ¼æœ¬èº«å°±æ˜¯ä½ çš„ï¼Œç›´æ¥å¾ Google è¡¨æ ¼ä¸‹è¼‰æˆ–åŒ¯å‡ºå³å¯ã€‚</div></div>
      </div>
      <div class="faq-item" data-faq="8">
        <div class="faq-q">é€™å€‹å¯ä»¥é›¢ç·šå—ï¼Ÿ</div>
        <div class="faq-a"><div class="faq-a-inner">å®‰è£åˆ°æ¡Œé¢å¾Œæœƒæœ‰éƒ¨åˆ†å¿«å–ï¼Œä½†è®€å¯«è³‡æ–™éœ€è¦ç¶²è·¯ã€‚ç¶²è·¯è¼ƒç©©æ™‚ä½¿ç”¨é«”é©—æœ€å¥½ã€‚</div></div>
      </div>
    </section>

    <!-- Troubleshooting -->
    <section class="trouble">
      <h2 class="section-title">æ’éŒ¯æŒ‡å—</h2>
      <div class="trouble-item">
        <div class="trouble-symptom">ç—‡ç‹€ï¼šæ¸¬è©¦é€£ç·šå¤±æ•—</div>
        <div class="trouble-fix">è§£æ³•ï¼šç¢ºèªç¶²å€å®Œæ•´ï¼ˆçµå°¾ç‚º /execï¼‰ã€å·²å®Œæˆã€Œéƒ¨ç½²ã€ã€æ¬Šé™é¸ã€Œä»»ä½•äººã€ã€‚å¯è©¦è‘—é‡æ–°éƒ¨ç½²ä¸€æ¬¡ã€‚</div>
      </div>
      <div class="trouble-item">
        <div class="trouble-symptom">ç—‡ç‹€ï¼šæ–°å¢ï¼æ›´æ–°æ²’åæ‡‰</div>
        <div class="trouble-fix">è§£æ³•ï¼šé‡æ–°æ•´ç†é é¢ã€æ”¹ç”¨ Chrome æˆ– Safariã€ç¢ºèªä¸æ˜¯ IG å…§å»ºç€è¦½å™¨ã€‚</div>
      </div>
      <div class="trouble-item">
        <div class="trouble-symptom">ç—‡ç‹€ï¼šå¦ä¸€åŠçœ‹ä¸åˆ°è³‡æ–™</div>
        <div class="trouble-fix">è§£æ³•ï¼šç¢ºèªå…©äººä½¿ç”¨åŒä¸€å€‹é€£ç·šç¶²å€ï¼Œæˆ–è¡¨æ ¼å·²åˆ†äº«çµ¦å°æ–¹ï¼ˆç·¨è¼¯æ¬Šé™ï¼‰ã€‚</div>
      </div>
    </section>

    <footer>
      <p>ç‰ˆæœ¬ v1.0 Â· <a href="https://forms.google.com/YOUR_FEEDBACK_FORM" target="_blank">å›é¥‹è¡¨å–®</a></p>
    </footer>
  </div>

  <script>
    // Config
    const CONFIG = {
      sheetTemplate: 'https://docs.google.com/spreadsheets/d/1_38-IQwS9Vj1iHzXWJAQ68WghhwBUvRGLVG8RobUDpg/copy',
      feedbackForm: 'https://forms.google.com/YOUR_FEEDBACK_FORM',
      settingsPage: './settings.html',
      appUrl: 'https://kittyandbear.github.io/todo/index.html'
    };
    const appUrl = CONFIG.appUrl || new URL('./index.html', window.location.href).href;
    const urlEl = document.getElementById('appUrlDisplay');
    if (urlEl) urlEl.textContent = 'ğŸŒ ' + appUrl;

    // Accordion
    function toggleAccordion(n) {
      const acc = document.getElementById('acc' + n);
      const card = document.querySelector('[data-step="' + n + '"]');
      if (acc) acc.classList.toggle('open');
      if (card) card.classList.toggle('open');
      // Step 10: å±•é–‹æ™‚è‡ªå‹•æ’­æ”¾å½±ç‰‡
      if (n === 10) {
        const videos = acc?.querySelectorAll('video');
        if (acc?.classList.contains('open') && videos?.length) {
          videos.forEach(v => v.play().catch(() => {}));
        } else if (videos?.length) {
          videos.forEach(v => { v.pause(); });
        }
      }
    }

    // FAQ accordion
    document.querySelectorAll('.faq-item').forEach(item => {
      item.querySelector('.faq-q').addEventListener('click', () => {
        item.classList.toggle('open');
      });
    });

    // Copy script - å¾é é¢ä¸Šçš„ç¨‹å¼ç¢¼å€å¡Šè¤‡è£½
    function copyScript() {
      const block = document.getElementById('scriptCode');
      const code = block ? block.textContent.trim() : '';
      navigator.clipboard.writeText(code).then(() => {
        const btn = block?.closest('.step-detail')?.querySelector('.copy-btn');
        if (btn) {
          const orig = btn.textContent;
          btn.textContent = 'âœ… å·²è¤‡è£½ï¼';
          setTimeout(() => { btn.textContent = orig; }, 2000);
        }
      }).catch(() => {
        alert('è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•é¸å–ä¸Šæ–¹ç¨‹å¼ç¢¼è¤‡è£½');
      });
    }

    // Update sheet template link
    document.querySelector('[href*="YOUR_TEMPLATE_ID"]')?.setAttribute('href', CONFIG.sheetTemplate);
    document.querySelector('footer a[href*="YOUR_FEEDBACK"]')?.setAttribute('href', CONFIG.feedbackForm);
  </script>
</body>
</html>
